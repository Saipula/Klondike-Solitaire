// ---------------------------------------------------------------------------

#ifndef classH
#define classH

#include <vector>
#include <System.Classes.hpp>
#include <Vcl.Controls.hpp>
#include <Vcl.StdCtrls.hpp>
#include <Vcl.ExtCtrls.hpp>

// ---------------------------------------------------------------------------
enum CARD_SUIT {
	// пики
	SPADES,
	// червы
		HEARTS,
	// трефы
		CLUBS,
	// буби
		DIAMONDS
};

struct SCard {
	CARD_SUIT Suit; // масть
	short Value; // значение карты от двойки до туза
	bool Visible; // true-карта видима
	TPicture *Pict; // Рисунок карты
	bool Select; // true-карта выбрана

	SCard() {
		Select = 0;
	}
} sCard_Box[13][53];

class Game {
	TCanvas *device;
	TPicture *back; // Рубашка карты
	TPoint *BOX_0_1, *BOX_2_8, *BOX_9_12; // Координаты начала отрисовки ящиков

	static const short Card_sm = 10; // смещение каждой следующей карты

	short Card_H, Card_W; // Размер карты
	short Client_H, Client_W; // Размер поля

	// ----------------------------------------------------------------------------------------------------
	// переместить карту из ящика s в ячейку d
	// ----------------------------------------------------------------------------------------------------
	bool MoveCard(short s, short d);
	// ----------------------------------------------------------------------------------------------------
	// перемещение карт внутри колоды
	// ----------------------------------------------------------------------------------------------------
	void RotatePool();
	// ----------------------------------------------------------------------------------------------------
	// получить количество карт в ящике
	// ----------------------------------------------------------------------------------------------------
	short GetCardInBox(short box);
	// ----------------------------------------------------------------------------------------------------
	// переместить карты из одного ящика в другой
	// ----------------------------------------------------------------------------------------------------
	void ChangeBox(short s_box, short s_index, short d_box);
	// ----------------------------------------------------------------------------------------------------
	// переместить карты с учётом правил
	// ----------------------------------------------------------------------------------------------------
	void ChangeCard(short s_box, short s_index, short d_box, short d_index);
	// ----------------------------------------------------------------------------------------------------
	// Нажатие на язик 2-8
	// ----------------------------------------------------------------------------------------------------
	void CkilBox2_8(short x, short y);
	// ----------------------------------------------------------------------------------------------------
	// Нажатие на язик 9-12
	// ----------------------------------------------------------------------------------------------------
	void CkilBox9_12(short x, short y);

	// ----------------------------------------------------------------------------------------------------
	// Структура выбраной карты
	// ----------------------------------------------------------------------------------------------------
	struct Select_Card {
		short col_num; // Номер выбраного ящика
		short card_num; // Номер выбраной карты

		Select_Card() {
			col_num = -1;
		}
	} Sel;

public:
	// ----------------------------------------------------------------------------------------------------
	// Конструктор
	// ----------------------------------------------------------------------------------------------------
	Game(TImage *img, TImageList *list);
	// ----------------------------------------------------------------------------------------------------
	// Отображение карт
	// ----------------------------------------------------------------------------------------------------
	void Show();
	// ----------------------------------------------------------------------------------------------------
	// Обработка нажатия на экран
	// ----------------------------------------------------------------------------------------------------
	void Click(short x, short y);
	// ----------------------------------------------------------------------------------------------------
	// Проверка на победу
	// ----------------------------------------------------------------------------------------------------
	bool Win();
};
#endif
